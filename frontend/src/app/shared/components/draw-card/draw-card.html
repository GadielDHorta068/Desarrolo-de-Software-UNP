<div class="shadow-md rounded-lg p-4 hover:shadow-lg transition" [ngClass]="customBackground()">
    <div class="flex gap-4">
        <img style="width: 30px; height: 30px;" [src]="event?.eventType | handleIconTypePipe" alt="">
        <h2 class="text-lg font-semibold text-emerald-600 mb-2 pl-1">{{event?.title}}</h2>
    </div>
    <div class="flex">
        <!-- columna de datos -->
        <div class="basis-1/2">
            <div *ngIf="showRegisteredStatus"
                class="bg-green-600 dark:bg-green-500 text-white px-4 py-1 rounded-lg text-sm font-medium flex items-center gap-2">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
                ESTAS INSCRITO
            </div>
            <div class="block" style="padding-top: 8px;">
                <p class="text-sm text-gray-200"><b>Dia de realizacion</b></p>
                <p class="text-sm text-gray-400 mb-1">{{event?.endDate | handleDatePipe}}</p>
            </div>
            <div class="block">
                <p class="text-sm text-gray-200"><b>Estado</b></p>
                <p class="text-sm text-gray-400 mb-1">{{event?.statusEvent | handleStatusPipe}}</p>
            </div>
        </div>
        <!-- columna de imagen -->
        <div class="basis-1/2 flex items-center">
            <img 
                [src]="event?.imageUrl ? 'data:image/jpeg;base64,' + event?.imageUrl : 'assets/no-image.jpg'" 
                [alt]="event?.title || 'Imagen del evento'"
                class="mx-auto min-w-[100px] max-h-[100px] object-cover rounded-lg"
                [class.border]="event?.imageUrl"
                [class.border-gray-300]="event?.imageUrl">
        </div>
    </div>

    <!-- botones de accion -->
    <div class="flex mt-2 justify-center gap-[4%] pt-1">
        <!-- Botón Ver detalles - siempre visible -->
        <!-- <button class="bg-emerald-600 dark:bg-emerald-500 hover:bg-emerald-700 dark:hover:bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" (click)="modalEventInfo.open()">Ver detalles</button> -->
        <button class="bg-emerald-600 dark:bg-emerald-500 hover:bg-emerald-700 dark:hover:bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" (click)="redirectAdmin()">Ver detalles</button>
        
        <!-- Botón Editar - solo visible para el creador -->
        <!-- <button 
            *ngIf="showEditButton"
            class="bg-blue-600 dark:bg-blue-300 hover:bg-blue-500 dark:hover:bg-blue-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" 
            (click)="redirectEdit()">
            Editar
        </button> -->

        <!-- Botón Cerrar inscripciones - sólo creador y cuando está ABIERTO -->
        <button
            *ngIf="isUserCreator && event?.statusEvent === StatusEvent.OPEN"
            class="bg-red-600 dark:bg-red-500 hover:bg-red-700 dark:hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
            (click)="closeRegistrations()">
            Cerrar evento
        </button>

        <!-- Botón Finalizar sorteo - sólo creador y cuando está CERRADO -->
        <button
            *ngIf="isUserCreator && event?.statusEvent === StatusEvent.CLOSED"
            class="bg-purple-600 dark:bg-purple-500 hover:bg-purple-700 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
            (click)="finalizeEvent()">
            Finalizar sorteo
        </button>
        
        <!-- Botón Inscribirme - solo visible si el usuario puede registrarse -->
        <button 
            *ngIf="showRegisterButton"
            class="bg-orange-600 dark:bg-orange-300 hover:bg-orange-500 dark:hover:bg-orange-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" 
            [disabled]="!event?.id" 
            (click)="openModal(event!.id)">
            Inscribirme
        </button>
        
        <!-- Estado Inscrito - visible si el usuario ya está registrado -->
        <!-- <div 
            *ngIf="showRegisteredStatus"
            class="bg-green-600 dark:bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
            </svg>
            Inscrito
        </div> -->
        
        <!-- Botón Inscribirme para invitados (sin autenticación) -->
        <button 
            *ngIf="!isAuthenticated && !isUserCreator && event?.statusEvent === StatusEvent.OPEN"
            class="bg-orange-600 dark:bg-orange-300 hover:bg-orange-500 dark:hover:bg-orange-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" 
            [disabled]="!event?.id" 
            (click)="openModal(event!.id)">
            Participar!
        </button>
        
        <!-- questionary-MODAL -->
        <app-questionary
            *ngIf = "showModal"
            (close) = "showModal = false"
            [eventId] = "selectedEventId"
        ></app-questionary>
        <!-- questionary-MODAL -->

    </div>
</div>

<app-modal-draw-info [dataEvent]="event" #modalEventInfo></app-modal-draw-info>

<!-- <div class="bg-white shadow-md rounded-lg p-4 hover:shadow-lg transition">
    <h2 class="text-lg font-semibold text-blue-600 mb-2">Sorteo #3</h2>
    <p class="text-sm text-gray-700 mb-1">Premio: Gift Card $1000</p>
    <p class="text-sm text-gray-700 mb-1">Fecha: 30/09/2025</p>
    <p class="text-sm text-gray-700 mb-3">Participantes: 200</p>
    <button class="mt-auto bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 text-sm">Ver detalles</button>
</div> -->

<app-modal-info [dataModal]="dataModal" #modalInfo></app-modal-info>