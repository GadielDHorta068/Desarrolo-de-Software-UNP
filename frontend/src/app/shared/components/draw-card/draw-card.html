<div class="relative shadow-md rounded-lg p-4 hover:shadow-lg transition border border-gray-200 dark:border-zinc-700 hover:border-emerald-600" [ngClass]="customBackground()">
  <app-loading-indicator [active]="isActionLoading" [type]="'overlay'" [message]="'Procesando...'" [size]="'md'"></app-loading-indicator>
    <div class="flex gap-4">
        <img style="width: 30px; height: 30px;" [src]="event?.eventType | handleIconTypePipe" alt="">
        <h2 class="text-lg font-semibold text-emerald-500 mb-2 pl-1">{{event?.title}}</h2>
    </div>
    <div class="flex">
        <!-- columna de datos -->
        <div class="basis-1/2">
            <div *ngIf="showRegisteredStatus"
                class="bg-green-600 dark:bg-green-500 text-white px-4 py-1 rounded-lg text-sm font-medium flex items-center gap-2">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
                ESTAS INSCRITO
            </div>
            <div class="block" style="padding-top: 8px;">
                <p class="text-sm text-gray-800 dark:text-gray-200"><b>Descripci贸n</b></p>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">{{event?.description}}</p>
            </div>
            <div class="block">
                <p class="text-sm text-gray-800 dark:text-gray-200"><b>Fecha fin</b></p>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">{{event?.endDate | handleDatePipe}}</p>
            </div>
            <div class="block">
                <p class="text-sm text-gray-800 dark:text-gray-200"><b>Estado</b></p>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">{{event?.statusEvent | handleStatusPipe}}</p>
            </div>
            <div class="block">
                <p class="text-sm text-gray-800 dark:text-gray-200"><b>Categor铆a</b></p>
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">{{event?.categoryName || 'Sin categor铆a'}}</p>
            </div>
            <div class="block">
                <p class="text-sm text-gray-800 dark:text-gray-200"><b>Reputacion del creador</b></p>
                <app-star-rating
                    [rating] = "avgScore"
                ></app-star-rating>
            </div>
        </div>
        <!-- columna de imagen -->
        <div class="basis-1/2 flex items-center">
            <img 
                [src]="event?.imageUrl ? 'data:image/jpeg;base64,' + event?.imageUrl : 'assets/no-image.jpg'" 
                [alt]="event?.title || 'Imagen del evento'"
                class="mx-auto min-w-[100px] max-h-[100px] object-cover rounded-lg"
                [class.border]="event?.imageUrl"
                [class.border-gray-300]="event?.imageUrl">
        </div>
    </div>

    <div *ngIf="event?.isPrivate" class="mt-2">
        <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
             Privado
        </span>
    </div>

    <!-- botones de accion -->
    <div class="flex mt-2 justify-center gap-[4%] pt-1">
        <!-- Bot贸n Ver detalles - siempre visible -->
        <button class="bg-emerald-600 dark:bg-emerald-500 hover:bg-emerald-700 dark:hover:bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" (click)="redirectAdmin()">Ver detalles</button>
        
        <!-- Bot贸n Cerrar inscripciones - s贸lo creador y cuando est谩 ABIERTO -->
        <button
            *ngIf="isUserCreator && event?.statusEvent === StatusEvent.OPEN"
            class="bg-red-600 dark:bg-red-500 hover:bg-red-700 dark:hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
            (click)="closeRegistrations()">
            Cerrar evento
        </button>

        <!-- Bot贸n Finalizar sorteo - s贸lo creador y cuando est谩 CERRADO -->
        <button
            *ngIf="isUserCreator && event?.statusEvent === StatusEvent.CLOSED"
            class="bg-purple-600 dark:bg-purple-500 hover:bg-purple-700 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
            (click)="finalizeEvent()">
            Finalizar sorteo
        </button>
        
        <!-- Bot贸n Inscribirme - solo visible si el usuario puede registrarse -->
        <button 
            *ngIf="!isAdmin && showRegisterButton"
            class="bg-orange-600 dark:bg-orange-300 hover:bg-orange-500 dark:hover:bg-orange-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2" 
            [disabled]="isActionLoading || !event?.id" 
            (click)="onInscript()">
            <app-loading-indicator [active]="isActionLoading" [type]="'inline'" [size]="'sm'"></app-loading-indicator>
            Inscribirme
        </button>
        
        <!-- Bot贸n Inscribirme para invitados (sin autenticaci贸n) -->
        <button 
            *ngIf="!isAdmin && !isAuthenticated && !isUserCreator && event?.statusEvent === StatusEvent.OPEN"
            class="bg-orange-600 dark:bg-orange-300 hover:bg-orange-500 dark:hover:bg-orange-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2" 
            [disabled]="isActionLoading || !event?.id" 
            (click)="onInscript()">
            <app-loading-indicator [active]="isActionLoading" [type]="'inline'" [size]="'sm'"></app-loading-indicator>
            Participar!
        </button>

        <!-- Bot贸n para ver la lista de reportes del evento -->
        <button 
            *ngIf="isAdmin"
            class="bg-orange-500 dark:bg-orange-500 hover:bg-orange-500 dark:hover:bg-orange-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" 
            [disabled]="!event?.id" 
            (click)="onRedirectReports()">
            Ver reportes
        </button>
    </div>
</div>

<app-modal-draw-info [dataEvent]="event" #modalEventInfo></app-modal-draw-info>
<app-modal-info [dataModal]="dataModal" #modalInfo></app-modal-info>
<!-- form de inscripcion a sorteos -->
 <!-- <app-questionary *ngIf = "showFormGiveaway" (close) = "showFormGiveaway = false" [eventId] = "selectedEventId"></app-questionary> -->